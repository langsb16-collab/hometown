<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ë„ API í†µí•© ì˜ˆì‹œ - RuralBase</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: #16a34a; }
        .map-container { height: 600px; margin: 20px 0; border: 2px solid #e5e7eb; border-radius: 8px; overflow: hidden; }
        .controls { margin: 20px 0; padding: 15px; background: #f3f4f6; border-radius: 8px; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-google { background: #4285F4; color: white; }
        .btn-naver { background: #03C75A; color: white; }
        .info { padding: 15px; background: #fef3c7; border-left: 4px solid #f59e0b; margin: 20px 0; border-radius: 4px; }
        pre { background: #1f2937; color: #f3f4f6; padding: 15px; border-radius: 8px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ºï¸ ì§€ë„ API í†µí•© ê°€ì´ë“œ</h1>
        
        <div class="info">
            <strong>âš ï¸ API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤</strong>
            <p>ì‹¤ì œ ì§€ë„ë¥¼ í‘œì‹œí•˜ë ¤ë©´ Google Maps ë˜ëŠ” Naver Maps API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
            <ul>
                <li><strong>Google Maps:</strong> <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a>ì—ì„œ ë°œê¸‰</li>
                <li><strong>Naver Maps:</strong> <a href="https://www.ncloud.com/product/applicationService/maps" target="_blank">Naver Cloud Platform</a>ì—ì„œ ë°œê¸‰</li>
            </ul>
        </div>

        <div class="controls">
            <h3>ì§€ë„ ì„ íƒ</h3>
            <button class="btn-google" onclick="alert('Google Maps API í‚¤ë¥¼ wrangler.jsoncì— ì„¤ì •í•˜ì„¸ìš”')">
                Google Maps ì‚¬ìš©
            </button>
            <button class="btn-naver" onclick="alert('Naver Maps API í‚¤ë¥¼ wrangler.jsoncì— ì„¤ì •í•˜ì„¸ìš”')">
                Naver Maps ì‚¬ìš©
            </button>
        </div>

        <div class="map-container" id="map">
            <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: #f3f4f6; color: #6b7280;">
                <div style="text-align: center;">
                    <svg style="width: 100px; height: 100px; margin-bottom: 20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                    </svg>
                    <h3>ì§€ë„ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</h3>
                    <p>API í‚¤ë¥¼ ì„¤ì •í•˜ê³  ìœ„ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</p>
                </div>
            </div>
        </div>

        <h2>ğŸ”§ Google Maps í†µí•© ì˜ˆì‹œ</h2>
        <pre><code>// 1. HTMLì— Google Maps API ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
&lt;script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer&gt;&lt;/script&gt;

// 2. ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜
async function initGoogleMap() {
    // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    const housesRes = await axios.get('/api/empty-houses/map/markers');
    const farmsRes = await axios.get('/api/smart-farms/map/markers');
    
    // ì§€ë„ ìƒì„± (ëŒ€í•œë¯¼êµ­ ì¤‘ì‹¬)
    const map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 36.5, lng: 127.5 },
        zoom: 7
    });
    
    // ë¹ˆì§‘ ë§ˆì»¤ ì¶”ê°€
    housesRes.data.data.forEach(house => {
        const marker = new google.maps.Marker({
            position: { lat: house.lat, lng: house.lng },
            map: map,
            title: house.address,
            icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'
        });
        
        // ì •ë³´ì°½ ì¶”ê°€
        const infoWindow = new google.maps.InfoWindow({
            content: \`
                &lt;div style="padding: 10px;"&gt;
                    &lt;h3 style="margin: 0 0 10px 0;"&gt;\${house.house_type || 'ì£¼íƒ'}&lt;/h3&gt;
                    &lt;p&gt;\${house.address}&lt;/p&gt;
                    &lt;p&gt;&lt;strong&gt;ê°€ê²©:&lt;/strong&gt; \${(house.price / 100).toFixed(0)}ì–µì›&lt;/p&gt;
                    &lt;p&gt;&lt;strong&gt;ìœ í˜•:&lt;/strong&gt; \${house.rental_type}&lt;/p&gt;
                &lt;/div&gt;
            \`
        });
        
        marker.addListener('click', () => {
            infoWindow.open(map, marker);
        });
    });
    
    // ìŠ¤ë§ˆíŠ¸íŒœ ë§ˆì»¤ ì¶”ê°€
    farmsRes.data.data.forEach(farm => {
        const marker = new google.maps.Marker({
            position: { lat: farm.lat, lng: farm.lng },
            map: map,
            title: farm.name,
            icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png'
        });
        
        const infoWindow = new google.maps.InfoWindow({
            content: \`
                &lt;div style="padding: 10px;"&gt;
                    &lt;h3 style="margin: 0 0 10px 0;"&gt;\${farm.name}&lt;/h3&gt;
                    &lt;p&gt;\${farm.address}&lt;/p&gt;
                    &lt;p&gt;&lt;strong&gt;ìœ í˜•:&lt;/strong&gt; \${farm.farm_type}&lt;/p&gt;
                    &lt;p&gt;&lt;strong&gt;ì‘ë¬¼:&lt;/strong&gt; \${farm.crop_type}&lt;/p&gt;
                &lt;/div&gt;
            \`
        });
        
        marker.addListener('click', () => {
            infoWindow.open(map, marker);
        });
    });
}</code></pre>

        <h2>ğŸ”§ Naver Maps í†µí•© ì˜ˆì‹œ</h2>
        <pre><code>// 1. HTMLì— Naver Maps API ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
&lt;script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=YOUR_CLIENT_ID"&gt;&lt;/script&gt;

// 2. ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜
async function initNaverMap() {
    // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    const housesRes = await axios.get('/api/empty-houses/map/markers');
    const farmsRes = await axios.get('/api/smart-farms/map/markers');
    
    // ì§€ë„ ìƒì„± (ëŒ€í•œë¯¼êµ­ ì¤‘ì‹¬)
    const map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(36.5, 127.5),
        zoom: 7
    });
    
    // ë¹ˆì§‘ ë§ˆì»¤ ì¶”ê°€
    housesRes.data.data.forEach(house => {
        const marker = new naver.maps.Marker({
            position: new naver.maps.LatLng(house.lat, house.lng),
            map: map,
            title: house.address,
            icon: {
                content: '&lt;div style="background: #3B82F6; color: white; padding: 8px; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;"&gt;ğŸ &lt;/div&gt;',
                anchor: new naver.maps.Point(15, 15)
            }
        });
        
        // ì •ë³´ì°½ ì¶”ê°€
        const infoWindow = new naver.maps.InfoWindow({
            content: \`
                &lt;div style="padding: 15px; min-width: 200px;"&gt;
                    &lt;h3 style="margin: 0 0 10px 0; font-size: 16px;"&gt;\${house.house_type || 'ì£¼íƒ'}&lt;/h3&gt;
                    &lt;p style="margin: 5px 0; font-size: 14px;"&gt;\${house.address}&lt;/p&gt;
                    &lt;p style="margin: 5px 0;"&gt;&lt;strong&gt;ê°€ê²©:&lt;/strong&gt; \${(house.price / 100).toFixed(0)}ì–µì›&lt;/p&gt;
                    &lt;p style="margin: 5px 0;"&gt;&lt;strong&gt;ìœ í˜•:&lt;/strong&gt; \${house.rental_type}&lt;/p&gt;
                &lt;/div&gt;
            \`
        });
        
        naver.maps.Event.addListener(marker, 'click', () => {
            if (infoWindow.getMap()) {
                infoWindow.close();
            } else {
                infoWindow.open(map, marker);
            }
        });
    });
    
    // ìŠ¤ë§ˆíŠ¸íŒœ ë§ˆì»¤ ì¶”ê°€
    farmsRes.data.data.forEach(farm => {
        const marker = new naver.maps.Marker({
            position: new naver.maps.LatLng(farm.lat, farm.lng),
            map: map,
            title: farm.name,
            icon: {
                content: '&lt;div style="background: #10B981; color: white; padding: 8px; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;"&gt;ğŸšœ&lt;/div&gt;',
                anchor: new naver.maps.Point(15, 15)
            }
        });
        
        const infoWindow = new naver.maps.InfoWindow({
            content: \`
                &lt;div style="padding: 15px; min-width: 200px;"&gt;
                    &lt;h3 style="margin: 0 0 10px 0; font-size: 16px;"&gt;\${farm.name}&lt;/h3&gt;
                    &lt;p style="margin: 5px 0; font-size: 14px;"&gt;\${farm.address}&lt;/p&gt;
                    &lt;p style="margin: 5px 0;"&gt;&lt;strong&gt;ìœ í˜•:&lt;/strong&gt; \${farm.farm_type}&lt;/p&gt;
                    &lt;p style="margin: 5px 0;"&gt;&lt;strong&gt;ì‘ë¬¼:&lt;/strong&gt; \${farm.crop_type}&lt;/p&gt;
                &lt;/div&gt;
            \`
        });
        
        naver.maps.Event.addListener(marker, 'click', () => {
            if (infoWindow.getMap()) {
                infoWindow.close();
            } else {
                infoWindow.open(map, marker);
            }
        });
    });
}</code></pre>

        <h2>ğŸ“ wrangler.jsonc ì„¤ì • ì˜ˆì‹œ</h2>
        <pre><code>{
  "name": "webapp",
  "compatibility_date": "2025-12-11",
  "pages_build_output_dir": "./dist",
  "compatibility_flags": ["nodejs_compat"],
  
  // í™˜ê²½ ë³€ìˆ˜ë¡œ API í‚¤ ì„¤ì •
  "vars": {
    "GOOGLE_MAPS_API_KEY": "your-google-maps-api-key",
    "NAVER_MAPS_CLIENT_ID": "your-naver-maps-client-id"
  },
  
  "d1_databases": [
    {
      "binding": "DB",
      "database_name": "webapp-production",
      "database_id": "placeholder-id"
    }
  ]
}</code></pre>

        <h2>ğŸ¯ ë‹¤ìŒ ë‹¨ê³„</h2>
        <ol>
            <li>Google Cloud Console ë˜ëŠ” Naver Cloud Platformì—ì„œ API í‚¤ ë°œê¸‰</li>
            <li>wrangler.jsoncì— API í‚¤ ì¶”ê°€</li>
            <li>src/index.tsxì— ì§€ë„ ì´ˆê¸°í™” ì½”ë“œ ì¶”ê°€</li>
            <li>ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸</li>
            <li>Cloudflare Pagesì— ë°°í¬</li>
        </ol>

        <div class="info" style="background: #dcfce7; border-left-color: #16a34a;">
            <strong>âœ… í˜„ì¬ êµ¬í˜„ ìƒíƒœ</strong>
            <p>API ì—”ë“œí¬ì¸íŠ¸ëŠ” ëª¨ë‘ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. API í‚¤ë§Œ ì„¤ì •í•˜ë©´ ì¦‰ì‹œ ì§€ë„ í†µí•©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤!</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script>
        console.log('ì§€ë„ API í†µí•© ì˜ˆì‹œ í˜ì´ì§€ ë¡œë“œë¨');
        console.log('API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸:');
        
        // API í…ŒìŠ¤íŠ¸
        axios.get('/api/empty-houses/map/markers')
            .then(res => console.log('ë¹ˆì§‘ ë§ˆì»¤:', res.data.data.length + 'ê°œ'))
            .catch(err => console.error('ë¹ˆì§‘ API ì˜¤ë¥˜:', err));
            
        axios.get('/api/smart-farms/map/markers')
            .then(res => console.log('ìŠ¤ë§ˆíŠ¸íŒœ ë§ˆì»¤:', res.data.data.length + 'ê°œ'))
            .catch(err => console.error('ìŠ¤ë§ˆíŠ¸íŒœ API ì˜¤ë¥˜:', err));
    </script>
</body>
</html>
